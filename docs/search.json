[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About the LANDFIRE R Toolkit",
    "section": "",
    "text": "Welcome to the LANDFIRE R Toolkit ‚Äî your go-to hub for accelerating landscape analysis with LANDFIRE and R. Here, you‚Äôll find tested, ready-to-use R code that simplifies data access, processing, and visualization for your region. Whether you‚Äôre a seasoned analyst or just getting started, this site helps you fast-track your workflow and connect with a growing community of LANDFIRE users who are actively coding, sharing, and tackling real-world challenges.\nThis site will be updated frequently throughout the year to ensure accuracy and when advances are made, we‚Äôll share updated code."
  },
  {
    "objectID": "about.html#dont-start-from-scratch",
    "href": "about.html#dont-start-from-scratch",
    "title": "About the LANDFIRE R Toolkit",
    "section": "",
    "text": "Welcome to the LANDFIRE R Toolkit ‚Äî your go-to hub for accelerating landscape analysis with LANDFIRE and R. Here, you‚Äôll find tested, ready-to-use R code that simplifies data access, processing, and visualization for your region. Whether you‚Äôre a seasoned analyst or just getting started, this site helps you fast-track your workflow and connect with a growing community of LANDFIRE users who are actively coding, sharing, and tackling real-world challenges.\nThis site will be updated frequently throughout the year to ensure accuracy and when advances are made, we‚Äôll share updated code."
  },
  {
    "objectID": "about.html#have-questions-landfire-is-here-to-help.",
    "href": "about.html#have-questions-landfire-is-here-to-help.",
    "title": "About the LANDFIRE R Toolkit",
    "section": "Have questions? LANDFIRE is here to help.",
    "text": "Have questions? LANDFIRE is here to help.\n\nDo you have a LANDFIRE R Toolkit/coding question? Ask TNC\nDo you have a LANDFIRE question? Ask the LANDFIRE Helpdesk\nSearch (& subscribe to) the LANDFIRE YouTube Channel (see tutorials, Office Hours, quick demonstrations)"
  },
  {
    "objectID": "about.html#r-session-information",
    "href": "about.html#r-session-information",
    "title": "About the LANDFIRE R Toolkit",
    "section": "R Session Information",
    "text": "R Session Information\nWe will try our best to keep code up to date and use modern versions of R, R-Studio and all packages. That said, if you run into issues knowing our R Session info may help you troubleshoot. Here‚Äôs the specifics of our code runs:\n\n\n### Platform Information\n\n\n\n\n\n\n\n\n\nComponent\nValue\n\n\n\n\nversion\nR version 4.4.3 (2025-02-28 ucrt)\n\n\nos\nWindows 11 x64 (build 22631)\n\n\nsystem\nx86_64, mingw32\n\n\nui\nRTerm\n\n\nlanguage\n(EN)\n\n\ncollate\nEnglish_United States.utf8\n\n\nctype\nEnglish_United States.utf8\n\n\ntz\nAmerica/New_York\n\n\ndate\n2025-11-14\n\n\npandoc\n3.6.3 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)\n\n\nquarto\nNA @ C:~1.exe\n\n\nLibrary path\n[hidden]\n\n\n\n\n\nFinding R package dependencies ... [124/185] \b\b\b\b\b\b\b\b\b\b[125/185] \b\b\b\b\b\b\b\b\b\b[126/185] \b\b\b\b\b\b\b\b\b\b[127/185] \b\b\b\b\b\b\b\b\b\b[128/185] \b\b\b\b\b\b\b\b\b\b[129/185] \b\b\b\b\b\b\b\b\b\b[130/185] \b\b\b\b\b\b\b\b\b\b[131/185] \b\b\b\b\b\b\b\b\b\b[132/185] \b\b\b\b\b\b\b\b\b\b[133/185] \b\b\b\b\b\b\b\b\b\b[134/185] \b\b\b\b\b\b\b\b\b\b[135/185] \b\b\b\b\b\b\b\b\b\b[136/185] \b\b\b\b\b\b\b\b\b\b[137/185] \b\b\b\b\b\b\b\b\b\b[138/185] \b\b\b\b\b\b\b\b\b\b[139/185] \b\b\b\b\b\b\b\b\b\b[140/185] \b\b\b\b\b\b\b\b\b\b[141/185] \b\b\b\b\b\b\b\b\b\b[142/185] \b\b\b\b\b\b\b\b\b\b[143/185] \b\b\b\b\b\b\b\b\b\b[144/185] \b\b\b\b\b\b\b\b\b\b[145/185] \b\b\b\b\b\b\b\b\b\b[146/185] \b\b\b\b\b\b\b\b\b\b[147/185] \b\b\b\b\b\b\b\b\b\b[148/185] \b\b\b\b\b\b\b\b\b\b[149/185] \b\b\b\b\b\b\b\b\b\b[150/185] \b\b\b\b\b\b\b\b\b\b[151/185] \b\b\b\b\b\b\b\b\b\b[152/185] \b\b\b\b\b\b\b\b\b\b[153/185] \b\b\b\b\b\b\b\b\b\b[154/185] \b\b\b\b\b\b\b\b\b\b[155/185] \b\b\b\b\b\b\b\b\b\b[156/185] \b\b\b\b\b\b\b\b\b\b[157/185] \b\b\b\b\b\b\b\b\b\b[158/185] \b\b\b\b\b\b\b\b\b\b[159/185] \b\b\b\b\b\b\b\b\b\b[160/185] \b\b\b\b\b\b\b\b\b\b[161/185] \b\b\b\b\b\b\b\b\b\b[162/185] \b\b\b\b\b\b\b\b\b\b[163/185] \b\b\b\b\b\b\b\b\b\b[164/185] \b\b\b\b\b\b\b\b\b\b[165/185] \b\b\b\b\b\b\b\b\b\b[166/185] \b\b\b\b\b\b\b\b\b\b[167/185] \b\b\b\b\b\b\b\b\b\b[168/185] \b\b\b\b\b\b\b\b\b\b[169/185] \b\b\b\b\b\b\b\b\b\b[170/185] \b\b\b\b\b\b\b\b\b\b[171/185] \b\b\b\b\b\b\b\b\b\b[172/185] \b\b\b\b\b\b\b\b\b\b[173/185] \b\b\b\b\b\b\b\b\b\b[174/185] \b\b\b\b\b\b\b\b\b\b[175/185] \b\b\b\b\b\b\b\b\b\b[176/185] \b\b\b\b\b\b\b\b\b\b[177/185] \b\b\b\b\b\b\b\b\b\b[178/185] \b\b\b\b\b\b\b\b\b\b[179/185] \b\b\b\b\b\b\b\b\b\b[180/185] \b\b\b\b\b\b\b\b\b\b[181/185] \b\b\b\b\b\b\b\b\b\b[182/185] \b\b\b\b\b\b\b\b\b\b[183/185] \b\b\b\b\b\b\b\b\b\b[184/185] \b\b\b\b\b\b\b\b\b\b[185/185] Done!\nWARNING: One or more problems were discovered while enumerating dependencies.\n\n# C:/Users/rswaty/Documents/r_demos/code/events_error_troubleshooting.R --------\nError: C:/Users/rswaty/Documents/r_demos/code/events_error_troubleshooting.R:37:0: unexpected end of input\n35:   # #make valid - didn't help same warning\n36:   # rawsimple_union &lt;- st_make_valid(rawsimple_union)\n   ^\n\nPlease see `\u001b]8;;x-r-help:renv::dependencies\u0007?renv::dependencies\u001b]8;;\u0007` for more information.\n\n\n\n### Packages Used Across the Website\n\n\n\n\n\n\nPackage\nVersion\n\n\n\n\nknitr\nknitr\n1.50\n\n\nrenv\nrenv\n1.1.4\n\n\nsessioninfo\nsessioninfo\n1.2.3\n\n\nrmarkdown\nrmarkdown\n2.30\n\n\nexactextractr\nexactextractr\n0.10.0\n\n\nforeign\nforeign\n0.8.90\n\n\nhtmlwidgets\nhtmlwidgets\n1.6.4\n\n\nleaflet\nleaflet\n2.2.2\n\n\nrlandfire\nrlandfire\n2.0.1\n\n\nsf\nsf\n1.0.21\n\n\nterra\nterra\n1.8.80\n\n\ntidyverse\ntidyverse\n2.0.0\n\n\narcgisbinding\narcgisbinding\n1.0.1.311\n\n\nrmapshaper\nrmapshaper\n0.5.0\n\n\nunits\nunits\n0.8.7\n\n\njsonlite\njsonlite\n2.0.0\n\n\nleaflet.providers\nleaflet.providers\n2.0.0\n\n\nRColorBrewer\nRColorBrewer\n1.1.3\n\n\nscales\nscales\n1.4.0\n\n\nstringr\nstringr\n1.5.1"
  },
  {
    "objectID": "events.html",
    "href": "events.html",
    "title": "Work with LANDFIRE‚Äôs Events Data",
    "section": "",
    "text": "Kori Blankenship, fire ecologist from The Nature Conservancy has been working with LANDFIRE‚Äôs Public Events Geodatabase which is a large collection of disturbance and vegetation/fuel treatment events. This database is used by LANDFIRE to determine disturbance causality, and is useful for tracking trends in treatments."
  },
  {
    "objectID": "events.html#what-this-code-can-do-for-you",
    "href": "events.html#what-this-code-can-do-for-you",
    "title": "Work with LANDFIRE‚Äôs Events Data",
    "section": "What this code can do for you",
    "text": "What this code can do for you\nThe code below will process selected LANDFIRE Model Ready and Raw Events. The output is a layer with selected fire and non fire treatments for a selected time period.\nBasic steps:\n\nProcess non-fire treatments from Model Ready Events\nProcess prescribed fire treatments from Raw Events\nMake a single treatment layer with non-fire + prescribed fire"
  },
  {
    "objectID": "events.html#skills-learned",
    "href": "events.html#skills-learned",
    "title": "Work with LANDFIRE‚Äôs Events Data",
    "section": "Skills learned",
    "text": "Skills learned\n\nReading in data from a geodatabase using the arcgisbinding package (note there are ArcGIS requirements)\nSeveral data wrangling operations\nMaking quick maps in GGPLOT\nClean overlaps in polygons"
  },
  {
    "objectID": "events.html#set-up",
    "href": "events.html#set-up",
    "title": "Work with LANDFIRE‚Äôs Events Data",
    "section": "Set up",
    "text": "Set up\nFor this demo Kori downloaded the LANDFIRE Public Events Database then clipped it to a rectangle in north central Washington on the Okanogan-Wenatchee National Forest. For other landscapes or the entire US you can replace this .gdb file with the LANDFIRE geodatabase or one for your area of interest.\n\nCode to load packages and inputs\n\n### SET UP ----\n\n\n# install.packages(\"arcgisbinding\", repos=\"https://r.esri.com\", type=\"win.binary\")\n\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(rmapshaper)\nlibrary(units)\nlibrary(arcgisbinding)\n\n\n# initialize arc\narc.check_product() \n\n### ANCILLARY DATA ----\n\n# prescribed fire type classification\n# NOTE: I made this classification. It is not a LANDFIRE\n# product and should be reviewed by the user.\nrx_class &lt;- read_csv(\"inputs/rx_types_classified_updated28Dec.csv\")\n\n\n### NON FIRE TREATMENTS ----\n\n## Get the data ----\n\n# location of the ready Events example layer\nready_path &lt;- 'inputs\\\\events_example_data.gdb\\\\events_ready'\n\n# get the ready data from the gdb\nready_open &lt;- arc.open(path = ready_path)"
  },
  {
    "objectID": "events.html#explore-non-fire-treatments-for-a-time-period-of-interest-and-make-a-quick-map",
    "href": "events.html#explore-non-fire-treatments-for-a-time-period-of-interest-and-make-a-quick-map",
    "title": "Work with LANDFIRE‚Äôs Events Data",
    "section": "Explore non-fire treatments for a time period of interest (and make a quick map!)",
    "text": "Explore non-fire treatments for a time period of interest (and make a quick map!)\n\n# select non-fire treatments of interest for time period\n# list of non-fire treatment types of interest\nnonfire_types &lt;- c(\"Other Mechanical\", \"Mastication\", \"Thinning\", \"Harvest\")\n# where clause including the year and type of treatments\nwhere_nonfire &lt;- paste0(\n  \"Year &gt;= 2004 AND EVENT_TYPE IN ('\", paste(nonfire_types, collapse = \"', '\"), \"')\"\n  )\n\n# select features using the where clause\nready_select &lt;- arc.select(ready_open, where_clause = where_nonfire)\n\n# convert the selected data to an sf object\nready_sf &lt;- arc.data2sf(ready_select)\n\n# check it out\nggplot(data = ready_sf) +\n  geom_sf(aes(fill = Event_Type)) +\n  scale_fill_viridis_d() +\n  theme_minimal()\n\n\n\n\n\n\n\n## Clean ----\n\ntx_nonfire &lt;- ready_sf %&gt;%\n  # select columns of interest\n  select(Event_ID, Year, Event_Type, Event_Subtype, Agency, DB_Source, Start_Date, End_Date) %&gt;%\n  # add acres\n  mutate(Acres = round(as.numeric(set_units(st_area(.), \"acre\")), 1)) %&gt;%\n  # convert Start_Date and End_Date to date only fields; no time\n  mutate(DateStart = ymd(substring(Start_Date, first = 1, last = 10))) %&gt;%\n  mutate(DateEnd = ymd(substring(End_Date, first = 1, last = 10))) %&gt;%\n  # select final columns\n  select(Year, Event_Type)"
  },
  {
    "objectID": "events.html#explore-fire-treatments",
    "href": "events.html#explore-fire-treatments",
    "title": "Work with LANDFIRE‚Äôs Events Data",
    "section": "Explore fire treatments",
    "text": "Explore fire treatments\n\n### FIRE TREATMENTS ----\n\n## Get the data ----\n\n# location of the ready Events example layer\nraw_path &lt;- 'inputs\\\\events_example_data.gdb\\\\events_raw'\n\n# get the ready data from the gdb\nraw_open &lt;- arc.open(path = raw_path)\n\n# select fire treatments for the time period\n# list of fire treatment types of interest\nfire_types &lt;- c(\"Prescribed Fire\")\n# where clause including the year and type of treatments\nwhere_fire &lt;- paste0(\n  \"Year &gt;= 2004 AND EVENT_TYPE IN ('\", paste(fire_types, collapse = \"', '\"), \"')\"\n  )\n\n# select features using the where clause\nraw_select &lt;- arc.select(raw_open, where_clause = where_fire)\n\n# convert the selected data to an sf object\nraw_sf &lt;- arc.data2sf(raw_select) %&gt;%\n  # make valid\n  st_make_valid(raw_sf) \n\n# check it out\nggplot(data = raw_sf) +\n  geom_sf(aes(fill = Event_Type)) +\n  scale_fill_viridis_d() +\n  theme_minimal()\n\n\n\n\n\n\n\n## Clean ----\n\nraw_clean &lt;- raw_sf %&gt;%\n  # select columns of interest\n  select(Event_ID, Year, Event_Type, Event_Subtype, Agency, DB_Source, Start_Date, End_Date) %&gt;%\n  # join the prescribed fire class using the look up table\n  left_join(rx_class, by = c(\"Event_Type\", \"Event_Subtype\")) %&gt;%\n  # add acres \n  mutate(Acres = round(as.numeric(set_units(st_area(.), \"acre\")), 1)) %&gt;%\n  # convert Start_Date and End_Date to date only fields; no time\n  mutate(DateStart = ymd(substring(Start_Date, first = 1, last = 10))) %&gt;%\n  mutate(DateEnd = ymd(substring(End_Date, first = 1, last = 10))) %&gt;%\n  # remove some columns\n  select(-c(Start_Date, End_Date))"
  },
  {
    "objectID": "events.html#clean-overlaps",
    "href": "events.html#clean-overlaps",
    "title": "Work with LANDFIRE‚Äôs Events Data",
    "section": "Clean overlaps",
    "text": "Clean overlaps\n\n## Remove overlaps ----\n\n# List of years to process\nyear_list &lt;- c(2004:2023) \n\n# list of types for final treatment layer\ntype_list &lt;- c(\"Burn_broadcast\", \"Burn_pile\", \"Burn_unknown\")  \n\n# prep dataframe for the loops that will remove overlaps below\nrawsimple &lt;- raw_clean %&gt;%\n  # adjust the treatment type so that includes the class\n  mutate(Event_Type = case_when(\n    Event_Type == \"Prescribed Fire\" & Class == \"Broadcast\" ~ \"Burn_broadcast\",\n    Event_Type == \"Prescribed Fire\" & Class == \"Pile\" ~ \"Burn_pile\",\n    Event_Type == \"Prescribed Fire\" & Class == \"Unknown\" ~ \"Burn_unknown\",\n    .default = Event_Type)) %&gt;%\n  # select columns of interest\n  select(Year, Event_Type)\n\n## Remove overlaps, within type ----\n# remove overlapping polygons of the same type within the same year\n# e.g. 2 pile burns in the same location in the same year\n\nunion_polys &lt;- list()\n\nfor (year in year_list) { \n  for (type in type_list) {\n    \n    # filter for year/type combo\n    filtered &lt;- rawsimple %&gt;% filter(Year == year, Event_Type == type)\n    \n    # union\n    union_filtered &lt;- st_union(filtered)\n    \n    # check if union_filtered is empty or has a single geometry\n    if (length(union_filtered) == 0) {\n      next  # skip to the next iteration if no geometries\n    }\n    \n    # convert the result back to an sf object, add year and type\n    # st_union returns a geometry collection, not a full sf object \n    union_final &lt;- st_as_sf(data.frame(geometry = union_filtered, \n                                       Year = year,\n                                       Event_Type = type))\n    \n    # store the result in the list\n    union_polys[[paste0(\"y\", year, \"_\", type)]] &lt;- union_final\n  }\n}\n\n# combine all year/type unioned layers\nrawsimple_union &lt;- bind_rows(union_polys)\n\n# explicitly make a valid sf object\nrawsimple_union &lt;- st_as_sf(rawsimple_union)\nrawsimple_union &lt;- st_make_valid(rawsimple_union)\n\n## Remove overlaps, between types ----\n# remove overlapping polygons of different types within the same year\n# e.g. a broadcast and a pile burn in the same location in the same year\n# When overlpping fire polygons are found in the same year, overlaps are\n# removed based on this order of priority: broadcast, pile, unknown. In\n# other words, if a broadcast burn overlaps a pile burn in the same year,\n# the area of overlap is assigned the type broadcast. When a pile\n# burn overlaps an unknown burn in the same year, the area of overlap is\n# assigned the type pile.\n\n# Initialize an empty list to store final results\nfinal_results &lt;- list()\n\nfor (year in year_list) {\n  \n  # filter for each type\n  broadcast &lt;- rawsimple_union %&gt;% filter(Year == year, Event_Type == \"Burn_broadcast\")\n  pile &lt;- rawsimple_union %&gt;% filter(Year == year, Event_Type == \"Burn_pile\")\n  unknown &lt;- rawsimple_union %&gt;% filter(Year == year, Event_Type == \"Burn_unknown\")\n  \n  # remove broadcast from piles\n  if (nrow(pile) &gt; 0 && nrow(broadcast) &gt; 0) {\n    pile_only &lt;- ms_erase(pile, erase = broadcast)\n  } else {\n    pile_only &lt;- pile\n  }\n  # combine broadcast and clean piles\n  bcast_pile &lt;- rbind(broadcast, pile_only)\n  \n  # remove broadcast/pile from unknown\n  if (nrow(unknown) &gt; 0 && nrow(bcast_pile) &gt; 0) {\n    unknown_only &lt;- ms_erase(unknown, erase = bcast_pile)\n  } else {\n    unknown_only &lt;- unknown\n  }\n  # combine broadcast/pile with clean unknown\n  bcast_pile_unk &lt;- rbind(broadcast, pile_only, unknown_only)\n  \n  # store the result in the list\n  final_results[[paste0(\"final\", year)]] &lt;- bcast_pile_unk\n}\n\n## Note ----\n# a warning is generated here. I'm not sure why and multiple\n# attempts to resolve the warning have failed. The results seem OK.\n\n# combine final results for all years\ntx_fire &lt;- bind_rows(final_results)\n\n# check it out\nggplot(data = tx_fire) +\n  geom_sf(aes(fill = Event_Type)) +\n  scale_fill_viridis_d() +\n  theme_minimal()"
  },
  {
    "objectID": "events.html#combine-all-treatments",
    "href": "events.html#combine-all-treatments",
    "title": "Work with LANDFIRE‚Äôs Events Data",
    "section": "Combine all treatments",
    "text": "Combine all treatments\n\n### COMBINE ALL TREATMENTS ----\n\ntx_all &lt;- tx_nonfire %&gt;%\n  bind_rows(tx_fire)\n\n# check it out\nggplot(data = tx_all) +\n  geom_sf(aes(fill = Event_Type)) +\n  scale_fill_viridis_d() +\n  theme_minimal()"
  },
  {
    "objectID": "events.html#notes-on-results",
    "href": "events.html#notes-on-results",
    "title": "Work with LANDFIRE‚Äôs Events Data",
    "section": "Notes on results",
    "text": "Notes on results\n\nThe tx_nonfire layer represents individual treatment polygons.\nThe tx_fire layer represents the footprint of a given prescribed fire type in a given year. For example, a give year, e.g.¬†2020, can have up to 3 polygons: one for the footprint for broadcast burns, one for pile, and one for unknown burns. Some years have fewer than three polygons because not all burn types were present in all years. Because the original treatment polygons were unioned, individual treatment units are no longer present in the data.\nThe tx_nofire layer could be further processed to union polygons by year to produce a layer equivalent to tx_fire.\nAs processed here, the data are adequate for visualizing and calculating footprint area of non-fire and fire treatments per year.\n‚ÄúFootprint‚Äù area is the area of non-overlapping polygons. Overlapping polygons are not present in the Events Ready data used to create tx_nonfire, and I removed overlapping polygons from the Events Raw to produce tx_fire in the code above.\nIn many areas, treatments overlap between years; e.g., a thin in 2020 followed by a pile burn in 2021. Use transparency to better visualize where multiple entries have occurred.\nUsers should review documentation on landfire.gov to understand Events data, especially the difference between Events Ready and Events raw."
  },
  {
    "objectID": "make_charts.html",
    "href": "make_charts.html",
    "title": "Make charts with LANDFIRE data",
    "section": "",
    "text": "Use this page to:\n\nPractice summarizing LANDFIRE Biophysical Settings data using R to identify dominant vegetation types across the example landscape\nCreate bar charts to visualize relative percentages and acerage, gaining experience in data grouping, plotting, and interpretation"
  },
  {
    "objectID": "make_charts.html#skills-learned",
    "href": "make_charts.html#skills-learned",
    "title": "Make charts with LANDFIRE data",
    "section": "",
    "text": "Use this page to:\n\nPractice summarizing LANDFIRE Biophysical Settings data using R to identify dominant vegetation types across the example landscape\nCreate bar charts to visualize relative percentages and acerage, gaining experience in data grouping, plotting, and interpretation"
  },
  {
    "objectID": "make_charts.html#set-up",
    "href": "make_charts.html#set-up",
    "title": "Make charts with LANDFIRE data",
    "section": "Set up",
    "text": "Set up\nTo run the code below you will need to:\n\nWork through the preceding pages, Download data and Prepare rasters for your own Area of Interest OR\nMake sure you have a datasheet with BpS names and Relative Percentages at the least. We will load in the data for our Area of Interest for you to work with if you do not have your own data."
  },
  {
    "objectID": "make_charts.html#code-to-load-packages-and-inputs-summarize-data",
    "href": "make_charts.html#code-to-load-packages-and-inputs-summarize-data",
    "title": "Make charts with LANDFIRE data",
    "section": "Code to load packages and inputs, summarize data",
    "text": "Code to load packages and inputs, summarize data\n\n# load packages\nlibrary(tidyverse)\nlibrary(scales)\nlibrary(stringr)\n\n# read in data for our Area of Interest\nbps_data &lt;- read.csv(\"outputs/bps_aoi_attributes.csv\")\nevt_data &lt;- read.csv(\"outputs/evt_aoi_attributes.csv\")"
  },
  {
    "objectID": "make_charts.html#basic-bar-chart-of-the-biophysical-settings",
    "href": "make_charts.html#basic-bar-chart-of-the-biophysical-settings",
    "title": "Make charts with LANDFIRE data",
    "section": "Basic bar chart of the Biophysical Settings",
    "text": "Basic bar chart of the Biophysical Settings\n\n# summarize data by BpS Name attribute for chart.  We do this as an AoI may have multiple variants if it crosses multiple Map Zones. We also limit output dataframe to the top 10 BpSs.  Customize as needed!\n\nbps_name &lt;- bps_data %&gt;%\n  group_by(BPS_NAME) %&gt;%\n  summarize(ACRES = sum(ACRES),\n            REL_PERCENT = sum(REL_PERCENT)) %&gt;%\n  arrange(desc(REL_PERCENT)) %&gt;%\n  top_n(n = 10, wt = REL_PERCENT)\n\n# plot\nbps_percent_chart &lt;- \n  ggplot(data = bps_name, aes(x = BPS_NAME, y = REL_PERCENT)) + \n  geom_bar(stat = \"identity\") +\n  labs(\n    title = \"Top 10 Biophysical Settings\",\n    subtitle = \"Represents dominant vegetation systems pre-European colonization\",\n    caption = \"Data from landfire.gov.\",\n    x = \"\",\n    y = \"Percent of landscape\") +\n  scale_x_discrete(limits = rev(bps_name$BPS_NAME),\n                   labels = function(x) str_wrap(x, width = 18)) +\n  coord_flip() +\n  theme_bw(base_size = 14)\n\n\nbps_acres_chart &lt;-\n  ggplot(data = bps_name, aes(x = BPS_NAME, y = ACRES)) + \n  geom_bar(stat = \"identity\") +\n  labs(\n    title = \"Top 10 Biophysical Settings\",\n    subtitle = \"Represents dominant vegetation systems pre-European colonization\",\n    caption = \"Data from landfire.gov.\",\n    x = \"\",\n    y = \"Acres\") +\n  scale_x_discrete(limits = rev(bps_name$BPS_NAME),\n                   labels = function(x) str_wrap(x, width = 18)) +\n  coord_flip() +\n  theme_bw(base_size = 14) +\n  scale_y_continuous(labels = comma)\n\nbps_acres_chart\n\n\n\n\n\n\n\n\n\nThis chart can be easily replicated for the Existing Vegetation Type data by swapping out input data and names in the chart code. Give it a try!"
  },
  {
    "objectID": "make_charts.html#fire-return-interval-per-bps",
    "href": "make_charts.html#fire-return-interval-per-bps",
    "title": "Make charts with LANDFIRE data",
    "section": "Fire return interval per BpS",
    "text": "Fire return interval per BpS\n\n# Rename columns for clarity\nbps_data_clean &lt;- bps_data %&gt;%\n  rename(\n    Replacement = FRI_REPLAC,\n    Mixed = FRI_MIXED,\n    Surface = FRI_SURFAC\n  )\n\n# Filter top 10 BPS_NAMEs by REL_PERCENT\ntop_bps &lt;- bps_data_clean %&gt;%\n  arrange(desc(REL_PERCENT)) %&gt;%\n  slice_head(n = 10) %&gt;%\n  mutate(\n    BPS_LABEL = paste0(BPS_NAME, \" (\", round(REL_PERCENT), \"%)\")\n  )\n\n# Reshape to long format\nbps_long &lt;- top_bps %&gt;%\n  select(BPS_LABEL, REL_PERCENT, Replacement, Mixed, Surface) %&gt;%\n  pivot_longer(cols = c(Replacement, Mixed, Surface),\n               names_to = \"Fire_Regime\",\n               values_to = \"Years\") %&gt;%\n  filter(Years &gt;= 0)\n\n# Set order of Fire types\nbps_long$Fire_Regime &lt;- factor(bps_long$Fire_Regime, levels = c(\n  \"Surface\",\n  \"Mixed\",\n  \"Replacement\"\n))\n\n# Order BPS_LABEL by REL_PERCENT\nbps_long$BPS_LABEL &lt;- factor(bps_long$BPS_LABEL,\n                             levels = top_bps$BPS_LABEL[order(top_bps$REL_PERCENT, decreasing = TRUE)])\n\n# Plot\n fri_chart &lt;- \n  ggplot(bps_long, aes(x = Years, y = Fire_Regime)) +\n  geom_bar(stat = \"identity\", \n           fill = \"grey50\",\n           width = 0.8, ) +  # grey bars\n  facet_wrap(~ BPS_LABEL, \n             scales = \"free_x\",\n             labeller = label_wrap_gen(width = 25), \n             nrow(3)) +\n  theme_minimal(base_size = 12) +\n  labs(\n    title = \"Historical Fire Regimes\",\n    subtitle = \"Top 10 BpSs selected for illustration. Replacement = 75 - 100% top kill, Mixed = 26 - 74%, Surface = 0 - 25%\",\n    caption = \"\\nData from landfire.gov.\",\n    x = \"Average years between fires\",\n    y = \"\") +\n  theme(plot.caption = element_text(hjust = 0, face= \"italic\"), #Default is hjust=1\n        plot.title.position = \"plot\", #NEW parameter. Apply for subtitle too.\n        plot.caption.position =  \"plot\") +\n  theme(panel.spacing = unit(.05, \"lines\"),\n        panel.border = element_rect(color = \"black\", fill = NA, linewidth = 1), \n        strip.background = element_rect(color = \"black\", linewidth  = 1))\n\n fri_chart"
  },
  {
    "objectID": "download.html",
    "href": "download.html",
    "title": "Download LANDFIRE data into R",
    "section": "",
    "text": "Use this page to:\n\nDownload and prepare LANDFIRE data using the rlandfire package (developed by Mark Buckner), including setting up a project environment and managing spatial data files\nDefine an area of interest, interact with the LANDFIRE API, and organize downloaded data for future analysis"
  },
  {
    "objectID": "download.html#skills-learned",
    "href": "download.html#skills-learned",
    "title": "Download LANDFIRE data into R",
    "section": "",
    "text": "Use this page to:\n\nDownload and prepare LANDFIRE data using the rlandfire package (developed by Mark Buckner), including setting up a project environment and managing spatial data files\nDefine an area of interest, interact with the LANDFIRE API, and organize downloaded data for future analysis"
  },
  {
    "objectID": "download.html#datasets-used",
    "href": "download.html#datasets-used",
    "title": "Download LANDFIRE data into R",
    "section": "Datasets used",
    "text": "Datasets used\n\nLANDFIRE Biophysical Settings (BpS)\nExisting Vegetation Type (EVT)"
  },
  {
    "objectID": "download.html#set-up",
    "href": "download.html#set-up",
    "title": "Download LANDFIRE data into R",
    "section": "Set up",
    "text": "Set up\nTo run the code below you will need to:\n\nSet up a new R-Studio project, i.e.¬†‚Äúr_landfire_demos‚Äù\nCreate two directories, ‚Äúinputs‚Äù and ‚Äúoutputs‚Äù\nDownload ‚Äúbps_demo.zip‚Äù (clicking will initiate the download that will likely land in your ‚ÄúC:‚Äù directory) which contains:\n\nLANDFIRE Map Zone 35 shapefile\nBpS attributes file as a .csv\n\nExtract the ‚Äúbps_demo.zip‚Äù files into the ‚Äúinputs‚Äù sub-directory of your r-studio project.\nCreate and save a new r-script with a name such as ‚Äúbps_demo_code‚Äù.\n\nOnce this set up is complete, you should be able to copy/paste the code below into the r script you created above.\n\nCode to load packages and inputs\n\n# install packages if needed\n  # install.packages(\"foreign\")\n  # install.packages(\"rlandfire\")\n  # install.packages(\"sf\")\n  # install.packages(\"terra\")\n  # install.packages(\"tidyverse\")\n\n# load packages\n\nlibrary(foreign)\nlibrary(rlandfire)\nlibrary(sf)\nlibrary(terra)\nlibrary(tidyverse)\n\n\n# read in Area of Interest (aoi) shapefile, plot to check\n\nshp &lt;- st_read(\"inputs/map_zone_35.shp\", quiet = TRUE) %&gt;% \n  st_transform(crs = 5070) %&gt;%\n  st_union() %&gt;%\n  st_sf()\n\n\n\n\n# plot the shape for fun (not much to look at on it's own!)\nplot(shp)"
  },
  {
    "objectID": "download.html#download-manage-and-load-data",
    "href": "download.html#download-manage-and-load-data",
    "title": "Download LANDFIRE data into R",
    "section": "Download manage and load data",
    "text": "Download manage and load data\nTo obtain and manage LANDFIRE data we need to:\n\nDefine the Area of Interest (AOI): The code gets the area of interest from a shapefile.\nSet Parameters for the API Call: It specifies the product code, coordinate system (EPSG:4326), resolution (30 meters), and your email address for the API.\nCreate a Temporary File: A temporary file is created to save the downloaded data.\nCall the LANDFIRE API: The API is called with the specified parameters, and the data is saved to the temporary file.\nMake sure the downloaded data lands in a place where you can find and use it easily\n\nDefine the Destination Path: The destination path for the downloaded file is set.\nMove and Rename the File: The temporary file is moved to the destination path and renamed.\nCreate a Temporary Directory for Unzipping: A temporary directory is created to unzip the downloaded file.\nUnzip the File: The file is unzipped into the temporary directory.\nGet the List of Unzipped Files: A list of unzipped files is obtained.\nRename Each Unzipped File: Each unzipped file is renamed to ‚Äúlandfire_data‚Äù followed by its original extension.\nClean Up the Temporary Directory: The temporary directory and its contents are deleted.\n\n\nThe code below does that in roughly 2 minutes with an internet download speed of ~450mbs. Your times may vary.\n\naoi &lt;- getAOI(shp)\n\nproducts &lt;-  c(\"200BPS\", \"240EVT\")  # note, you can download multiple datasets at once\nprojection &lt;- 5070  \nresolution &lt;- 30\nemail &lt;- \"your_email@wah.org\" # REPLACE WITH YOUR E-MAIL ADDRESS PLEASE! \n\n# R specific arguments\nsave_file &lt;- tempfile(fileext = \".zip\")\n\n# call API\nncal &lt;- landfireAPIv2(\n  products, \n  aoi, \n  projection, \n  resolution, \n  path = save_file,\n  email = email)\n\n\n# define the destination path\ndest_file &lt;- file.path(\"inputs\", \"landfire_data.zip\")\n\n# move and rename the file\nfile.rename(save_file, dest_file)\n\n# create a temporary directory for unzipping\ntemp_dir &lt;- tempfile()\ndir.create(temp_dir)\n\n# unzip the file into the temporary directory\nunzip(dest_file, exdir = temp_dir)\n\n# get the list of unzipped files\nunzipped_files &lt;- list.files(temp_dir, full.names = TRUE)\n\n# rename each unzipped file to \"landfire_data\" with its full original extension\nfor (file in unzipped_files) {\n  file_name &lt;- basename(file)\n  file_extension &lt;- sub(\"^[^.]*\", \"\", file_name)  # Extract the full extension\n  new_file_path &lt;- file.path(\"inputs\", paste0(\"landfire_data\", file_extension))\n  file.rename(file, new_file_path)\n}\n\n# clean up the temporary directory\nunlink(temp_dir, recursive = TRUE)"
  },
  {
    "objectID": "download.html#next-steps",
    "href": "download.html#next-steps",
    "title": "Download LANDFIRE data into R",
    "section": "Next steps",
    "text": "Next steps\nYou should see a set of files with ‚Äúlandfire‚Äù in the name. Next go to the Prepare rasters page to learn how to load them into R, clip/mask and view them."
  },
  {
    "objectID": "download.html#more-resources",
    "href": "download.html#more-resources",
    "title": "Download LANDFIRE data into R",
    "section": "More resources",
    "text": "More resources\n\nMark Buckner‚Äôs rlandfire site also has a useful tutorial.\nThere is also a Python package for downloading LANDFIRE data, landfire-python. If you try this please let us know!"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "LANDFIRE + R: Accelerate Your Analysis",
    "section": "",
    "text": "Do you work with LANDFIRE data and want a faster way to dig into ecological patterns across your landscape? You‚Äôre in the right place.\nThis site features quick R code snippets to help you get started (or go deeper) with LANDFIRE data. We recognize the power of well-written code and encourage the LANDFIRE community to build on this foundation of work. These R code examples are designed to be practical, repeatable, and flexible to fit your needs. We hope the coding tools provided can help you automate your work, leverage LANDFIRE, and get solution-oriented support.\nWe want to hear from you. Do you have feedback, ideas, or a cool way you‚Äôre using LANDFIRE data with R? -&gt; Send them our way. Let‚Äôs build a community of practice together."
  },
  {
    "objectID": "index.html#why-this-site",
    "href": "index.html#why-this-site",
    "title": "LANDFIRE + R: Accelerate Your Analysis",
    "section": "",
    "text": "Do you work with LANDFIRE data and want a faster way to dig into ecological patterns across your landscape? You‚Äôre in the right place.\nThis site features quick R code snippets to help you get started (or go deeper) with LANDFIRE data. We recognize the power of well-written code and encourage the LANDFIRE community to build on this foundation of work. These R code examples are designed to be practical, repeatable, and flexible to fit your needs. We hope the coding tools provided can help you automate your work, leverage LANDFIRE, and get solution-oriented support.\nWe want to hear from you. Do you have feedback, ideas, or a cool way you‚Äôre using LANDFIRE data with R? -&gt; Send them our way. Let‚Äôs build a community of practice together."
  },
  {
    "objectID": "index.html#landfire",
    "href": "index.html#landfire",
    "title": "LANDFIRE + R: Accelerate Your Analysis",
    "section": "LANDFIRE",
    "text": "LANDFIRE\nLANDFIRE (Landscape Fire and Resource Management Planning Tools) LANDFIRE is a shared interagency wildland fire management data program across the United States and Territories. Leadership, management, and oversight are through the U.S. Department of Agriculture Forest Service - Fire and Aviation Management and the U.S. Department of the Interior ‚Äì Office of Wildland Fire.\nLANDFIRE provides more than twenty landscape-scale geospatial products of biological and ecological data, including data such as (900+) vegetation types and (13/40) fire behavior fuel models that support all-lands planning, fire and natural resources management, operations, analyses and assessments.\nProject Team: USGS EROS, EROS Technical Support Services Contract (KBR), The Nature Conservancy, USDA Forest Service (Rocky Mountain Research Station) RMRS, and Forest Inventory & Analysis (FIA)\nPartners: USGS Gap Analysis, USGS National Land Imaging Program"
  },
  {
    "objectID": "index.html#overview",
    "href": "index.html#overview",
    "title": "LANDFIRE + R: Accelerate Your Analysis",
    "section": "üîç Overview",
    "text": "üîç Overview\nStep 1: LANDFIRE Data ‚Äì Choose the LANDFIRE Product for your analysis. Need help deciding? Check the LANDFIRE Products here.\nStep 2: R Code Demos ‚Äì Use the sample R code on this site to explore your area of interest.\nStep 3: Adjust LANDFIRE to match local conditions. Not sure how to do that? Check out our tutorial.\nStep 4: Insights & Innovations ‚Äì Build your own tools, share your work, connect with us."
  },
  {
    "objectID": "index.html#making-connections",
    "href": "index.html#making-connections",
    "title": "LANDFIRE + R: Accelerate Your Analysis",
    "section": "üîç Making Connections",
    "text": "üîç Making Connections"
  },
  {
    "objectID": "index.html#working-example",
    "href": "index.html#working-example",
    "title": "LANDFIRE + R: Accelerate Your Analysis",
    "section": "üîß Working Example",
    "text": "üîß Working Example\nUsing R and LANDFIRE products to explore trends and automate analyses can improve outcomes. Based on current LANDFIRE Products, the example code and visualizations will all be based on Map Zone 35, located in Central Texas.\nContained in Map Zone 35 are multiple ecosystems that provide a colorful sandbox to explore these coding demonstrations.\nSee map of LANDFIRE Map Zones here. Note: some datasets are compiled by Map Zone so maps or analysis that crosses multiple may result in seamlines or other complications. Contact us to discuss at landfire@tnc.org."
  },
  {
    "objectID": "index.html#map-zone-35",
    "href": "index.html#map-zone-35",
    "title": "LANDFIRE + R: Accelerate Your Analysis",
    "section": "üó∫ Map Zone 35",
    "text": "üó∫ Map Zone 35"
  },
  {
    "objectID": "index.html#getting-started",
    "href": "index.html#getting-started",
    "title": "LANDFIRE + R: Accelerate Your Analysis",
    "section": "Getting Started",
    "text": "Getting Started\n\nCheck your R, R-Studio and package versions. We recommend running the most current version of R or R-Studio. See what we used\nCheck file paths - is your your R-Studio project correctly set up?\nLet us know if you run into code bugs landfire@tnc.org"
  },
  {
    "objectID": "index.html#disclaimer-the-fine-print",
    "href": "index.html#disclaimer-the-fine-print",
    "title": "LANDFIRE + R: Accelerate Your Analysis",
    "section": "Disclaimer (the fine print)",
    "text": "Disclaimer (the fine print)\nThe code provided here is offered as-is, without warranty or guarantee of accuracy, functionality, or fitness for a particular purpose. Like any open-source code, it may not perform identically across all systems, versions of R, RStudio, or associated packages. This content is intended for educational and illustrative purposes only and should not be considered a comprehensive guide to R programming. Users are responsible for validating and adapting the code to suit their specific needs and environments. We cannot assume responsibility for any issues, errors, or outcomes resulting from its use."
  },
  {
    "objectID": "prep_rasters.html",
    "href": "prep_rasters.html",
    "title": "Clip and prep LANDFIRE rasters",
    "section": "",
    "text": "Use this page to: - Clip LANDFIRE data to a specific landscape (for this example, Mapzone 34)\n\nCrop, mask and build attribute table for the area then write the files to our ‚Äòoutputs‚Äô folder for later use"
  },
  {
    "objectID": "prep_rasters.html#skills-learned",
    "href": "prep_rasters.html#skills-learned",
    "title": "Clip and prep LANDFIRE rasters",
    "section": "",
    "text": "Use this page to: - Clip LANDFIRE data to a specific landscape (for this example, Mapzone 34)\n\nCrop, mask and build attribute table for the area then write the files to our ‚Äòoutputs‚Äô folder for later use"
  },
  {
    "objectID": "prep_rasters.html#set-up",
    "href": "prep_rasters.html#set-up",
    "title": "Clip and prep LANDFIRE rasters",
    "section": "Set up",
    "text": "Set up\nTo run the code below you will need to:\n\nFollow the set up instructions and run the code on the Download data page, or similar for your landscape and LANDFIRE datasets of interest.\nCreate a new script for the following code.\n\nOnce this set up is complete, you should be able to copy/paste the code below into the r script you created above.\n\nCode to load packages and inputs\n\n# install packages if needed\n  # install.packages(\"foreign\")\n  # install.packages(\"sf\")\n  # install.packages(\"terra\")\n  # install.packages(\"tidyverse\")\n\n# load packages\n\nlibrary(foreign)\nlibrary(sf)\nlibrary(terra)\nlibrary(tidyverse)\n\n\n# read in Area of Interest (aoi) shapefile, plot to check\n\nshp &lt;- st_read(\"inputs/map_zone_35.shp\", quiet = TRUE) %&gt;% \n  st_transform(crs = 5070) %&gt;%\n  st_union() %&gt;%\n  st_sf()\n\n\n# read in .csv of CONUS-wide attributes for later joining to AoI BpS table\n\nbps_conus_atts &lt;- read_csv(\"inputs/LF20_BPS_220.csv\")\n\n# another way is directly from landfire.gov\n# bps_url &lt;- \"https://landfire.gov/sites/default/files/CSV/LF2016/LF16_BPS.csv\" # will likely get warning, but it's OK\n# bps_conus_atts &lt;- read.csv(bps_url)\n\n\nevt_conus_atts &lt;- read_csv(\"inputs/LF23_EVT_240.csv\")\n\n# evt_url &lt;- \"https://landfire.gov/sites/default/files/CSV/2024/LF2024_EVT.csv\" # will likely get warning, but it's OK\n# evt_conus_atts &lt;- read.csv(evt_url)\n\n\n# look at the first few rows of the CONUS-wide attribute tables\nprint(head(bps_conus_atts))\nprint(head(evt_conus_atts))"
  },
  {
    "objectID": "prep_rasters.html#crop-mask-and-split-out-the-raster-layers",
    "href": "prep_rasters.html#crop-mask-and-split-out-the-raster-layers",
    "title": "Clip and prep LANDFIRE rasters",
    "section": "Crop, mask and split out the raster layers",
    "text": "Crop, mask and split out the raster layers\nNow that we have LANDFIRE data for the extent of our area of interest, we need to crop/mask it to the exact area of interest, build the raster attribute table and do a few calculations:\n\nFirst, we load our stacked raster data from the file landfire_data.tif.\nNext, we crop and mask this raster using a shapefile to focus on our area of interest.\nWe then plot the cropped and masked raster to visualize our area of interest.\nWe set the levels of the raster to match our attribute data and specify the active category.\n\nExtracting and Processing Values: We extract values from the raster, remove any NA values, and convert the data into a dataframe. This dataframe is then processed to create a frequency table, which is further refined and joined with the raster categories.\nSaving the Results: Finally, we save the processed raster and the attributes dataframe to files for future use.\n\n# load in landfire stacked raster\nstacked_rasters &lt;- rast(\"inputs/landfire_data.tif\")\n\n# crop and mask stacked raster \naoi_stacked_rasters &lt;- stacked_rasters %&gt;%\n  crop(shp) %&gt;%\n  mask(shp)\n\n# \"split\" cropped and masked stacked raster into separate layers\nfor(lyr in names(aoi_stacked_rasters)) assign(lyr, aoi_stacked_rasters[[lyr]])"
  },
  {
    "objectID": "prep_rasters.html#build-raster-attribute-table-for-biophysical-settings-data-write-files",
    "href": "prep_rasters.html#build-raster-attribute-table-for-biophysical-settings-data-write-files",
    "title": "Clip and prep LANDFIRE rasters",
    "section": "Build Raster Attribute Table for Biophysical Settings Data, write files",
    "text": "Build Raster Attribute Table for Biophysical Settings Data, write files\n\n#| label: Build Raster Attribute Table for Biophysical Settings Data, write files\n#| echo: true\n#| message: false\n#| warning: false\n#| code-overflow: wrap\n#| include: true\n#| results: hide\n#| eval: false\n\n\n\n\n# Assign categories\nlevels(US_200BPS) &lt;- bps_conus_atts\nactiveCat(US_200BPS) &lt;- \"VALUE\"\n\n# Get frequency table \nbps_freq &lt;- freq(US_200BPS) %&gt;%\n  as.data.frame()\n\n# Join with attributes and calculate acres and percent\nbps_aoi_atts &lt;- bps_freq %&gt;%\n  rename(VALUE = value, COUNT = count) %&gt;%\n  mutate(VALUE = as.integer(VALUE)) %&gt;%\n  left_join(bps_conus_atts, by = \"VALUE\") %&gt;%\n  filter(COUNT != 0) %&gt;%\n  mutate(\n    ACRES = round((COUNT * 900 / 4046.86), 0),\n    REL_PERCENT = round((COUNT / sum(COUNT)) * 100, 3)) %&gt;%\n  arrange(desc(REL_PERCENT)) %&gt;%\n  select(-layer)  # Optional: remove 'layer' column\n\n# write the raster to a file with specified options\nwriteRaster(US_200BPS, \"outputs/bps_aoi.tif\",\n            gdal = c(\"COMPRESS=NONE\", \"TFW=YES\"),\n            datatype = \"INT2S\",\n            overwrite = T)\n\n\n|---------|---------|---------|---------|\n=========================================\n                                          \n\n# write the attributes dataframe to a dbf file\nwrite.dbf(bps_aoi_atts, \"outputs/bps_aoi.tif.vat.dbf\")\n\n# write the attributes dataframe to a csv file\nwrite.csv(bps_aoi_atts, \"outputs/bps_aoi_attributes.csv\")\n\n# plot the cropped and masked raster-will just show values in the map.  Output not shown here.\nplot(US_200BPS)\n\n\n\n\n\n\n\n# look at the first few rows of the aoi attributes. Output not shown here.\nprint(head(bps_aoi_atts))\n\n  VALUE    COUNT BPS_CODE ZONE         BPS_MODEL\n1  1718 46439852    11320   35    11320_32_34_35\n2  1725 44125598    13830   35    13830_32_35_36\n3  1728 16449562    13930   35       13930_32_35\n4  1730 13609703    14220   35 14220_32_35_36_37\n5  1723 11475228    13080   35       13080_32_35\n6  1737 10387249    15230   35       15230_32_35\n                                             BPS_NAME  GROUPVEG FRI_REPLAC\n1                          Central Mixedgrass Prairie Grassland          7\n2      Edwards Plateau Limestone Savanna and Woodland  Hardwood         15\n3                 Edwards Plateau Limestone Shrubland   Conifer         69\n4                Southern Blackland Tallgrass Prairie Grassland          3\n5                Crosstimbers Oak Forest and Woodland  Hardwood        158\n6 Edwards Plateau Dry-Mesic Slope Forest and Woodland  Hardwood        103\n  FRI_MIXED FRI_SURFAC FRI_ALLFIR PRC_REPLAC PRC_MIXED PRC_SURFAC FRG_NEW   R\n1        44         21          5         65        12         23     I-A 112\n2        24         14          6         38        23         39     I-B 209\n3        44      -9999         27         39        61      -9999     I-C 255\n4       171         35          2         91         2          7    II-A 255\n5        93          5          5          3         5         92     I-A 137\n6       133         30         20         19        15         66     I-C 102\n    G   B      RED    GREEN     BLUE    ACRES REL_PERCENT\n1 168 112 0.439216 0.658824 0.439216 10327974      26.029\n2 255 115 0.819608 1.000000 0.450980  9813297      24.732\n3 203 125 1.000000 0.796078 0.490196  3658295       9.220\n4 127 127 1.000000 0.498039 0.498039  3026725       7.628\n5  90  68 0.537255 0.352941 0.266667  2552029       6.432\n6 255 171 0.400000 1.000000 0.670588  2310069       5.822"
  },
  {
    "objectID": "prep_rasters.html#build-raster-attribute-table-for-existing-vegetation-type-data-write-files",
    "href": "prep_rasters.html#build-raster-attribute-table-for-existing-vegetation-type-data-write-files",
    "title": "Clip and prep LANDFIRE rasters",
    "section": "Build Raster Attribute Table for Existing Vegetation Type Data, write files",
    "text": "Build Raster Attribute Table for Existing Vegetation Type Data, write files\n\n# Assign categories\nlevels(US_240EVT) &lt;- evt_conus_atts\nactiveCat(US_240EVT) &lt;- \"VALUE\"\n\n# Get frequency table \nevt_freq &lt;- freq(US_240EVT) %&gt;%\n  as.data.frame()\n\n# Join with attributes and calculate acres and percent\nevt_aoi_atts &lt;- evt_freq %&gt;%\n  rename(VALUE = value, COUNT = count) %&gt;%\n  mutate(VALUE = as.integer(VALUE)) %&gt;%\n  left_join(evt_conus_atts, by = \"VALUE\") %&gt;%\n  filter(COUNT != 0) %&gt;%\n  mutate(\n    ACRES = round((COUNT * 900 / 4046.86), 0),\n    REL_PERCENT = round((COUNT / sum(COUNT)) * 100, 3)\n  ) %&gt;%\n  arrange(desc(REL_PERCENT)) %&gt;%\n  select(-layer)  # Optional: remove 'layer' column\n\n# write the raster to a file with specified options\nwriteRaster(US_240EVT, \"outputs/evt_aoi.tif\",\n            gdal = c(\"COMPRESS=NONE\", \"TFW=YES\"),\n            datatype = \"INT2S\",\n            overwrite = T)\n\n# write the attributes dataframe to a dbf file\nwrite.dbf(evt_aoi_atts, \"outputs/evt_aoi.tif.vat.dbf\")\n\n# write the attributes dataframe to a csv file\nwrite.csv(evt_aoi_atts, \"outputs/evt_aoi_attributes.csv\")\n\n# plot the cropped and masked raster-will just show values in the map.  Output not shown here.\nplot(US_240EVT)\n\n# look at the first few rows of the aoi attributes. Output not shown here.\nprint(head(evt_aoi_atts))"
  },
  {
    "objectID": "prep_rasters.html#next-steps",
    "href": "prep_rasters.html#next-steps",
    "title": "Clip and prep LANDFIRE rasters",
    "section": "Next steps",
    "text": "Next steps\nYou can now open up the processed raster(s) in ArcGIS pro and/or QGIS to do further GIS. This process really shines when you do multiple LANDFIRE datasets at once and/or process data for multiple landscapes. Further, you can work in Excel, R or other software to make charts of the attributes that are saved as a .csv file. Go to the Make Charts page to get started.\nWhile we are sure it is possible to make attractive, accessible maps with the processed LANDFIRE rasters in R, we typically move to a different GIS software for mapping, or summarize the data by polygons (e.g., watersheds or hexagons) in R. Try the code on the Make hex map for ways you might map LANDFIRE data in R."
  },
  {
    "objectID": "make_hex_map.html",
    "href": "make_hex_map.html",
    "title": "Make hexagon maps",
    "section": "",
    "text": "Use this page to:\n\nCreate hexagonal grids to summarize dominant LANFDIRE vegetation types across example landscape, enabling spatial analysis beyond raster cell comparisons\nBuild an interactive Leaflet map with toggle display to visualize dominant BpS and EVT within each hexagon"
  },
  {
    "objectID": "make_hex_map.html#skills-learned",
    "href": "make_hex_map.html#skills-learned",
    "title": "Make hexagon maps",
    "section": "",
    "text": "Use this page to:\n\nCreate hexagonal grids to summarize dominant LANFDIRE vegetation types across example landscape, enabling spatial analysis beyond raster cell comparisons\nBuild an interactive Leaflet map with toggle display to visualize dominant BpS and EVT within each hexagon"
  },
  {
    "objectID": "make_hex_map.html#set-up",
    "href": "make_hex_map.html#set-up",
    "title": "Make hexagon maps",
    "section": "Set up",
    "text": "Set up\nFor this work we will use the Area of Interest shapefile, and pre-downloaded BpS and EVT rasters. Before you can complete this page you will need to complete the work on the Download data and Prepare rasters pages.\n\nCode to load packages and inputs\n\n# Load packages\nlibrary(exactextractr)\nlibrary(jsonlite)\nlibrary(leaflet)\nlibrary(leaflet.providers)\nlibrary(RColorBrewer)\nlibrary(sf)\nlibrary(terra)\nlibrary(tidyverse)\n\n\n# read in Area of Interest (aoi) shapefile\n\nshp &lt;- st_read(\"inputs/map_zone_35.shp\", quiet = TRUE) %&gt;% \n  st_transform(crs = 5070) %&gt;%\n  st_union() %&gt;%\n  st_sf()\n\n# read in .csv of CONUS-wide attributes for later joining to AoI BpS table\n\nbps_conus_atts &lt;- read_csv(\"inputs/LF20_BPS_220.csv\")\n\n# another way is directly from landfire.gov\n# bps_url &lt;- \"https://landfire.gov/sites/default/files/CSV/LF2016/LF16_BPS.csv\" # will likely get warning, but it's OK\n# bps_conus_atts &lt;- read.csv(bps_url)\n\n\nevt_conus_atts &lt;- read_csv(\"inputs/LF23_EVT_240.csv\")\n\n# evt_url &lt;- \"https://landfire.gov/sites/default/files/CSV/2024/LF2024_EVT.csv\" # will likely get warning, but it's OK\n# evt_conus_atts &lt;- read.csv(evt_url)\n\n# load in landfire stacked raster\nstacked_rasters &lt;- rast(\"inputs/landfire_data.tif\")\n\n# \"split\" cropped and masked stacked raster into separate layers\nfor(lyr in names(stacked_rasters)) assign(lyr, stacked_rasters[[lyr]])\n\n\n\nMake hexgrid ~ 25,000 acres a piece\nIn this step we make a hexgrid map for our area of interest and confirm hexagon size.\n\n# Hexagon side length in meters for ~25,000 ac hexagons\nhex_side &lt;- 10930\n\n# Create full hex grid\nhex_grid &lt;- st_make_grid(shp,\n                         cellsize = hex_side,\n                         square = FALSE,\n                         what = \"polygons\") %&gt;%\n                          st_sf()\n\nhex_grid_clipped &lt;- st_intersection(hex_grid, shp) %&gt;%\n  mutate(index = row_number())\n\n\nplot(st_geometry(hex_grid_clipped))\n\n\n\n\n\n\n\n# Calculate area in square meters\nhex_grid_size &lt;- hex_grid %&gt;%\n  mutate(area_m2 = st_area(.),\n         area_acres = as.numeric(area_m2) / 4046.86)\n\n\n\nCalculate majority type per hexagon\nBelow we use the extactextractr package to extract the majority (most dominant) BpS value and EVT value per hexagon, the we join in a minimal number of attributes (e.g., EVT_NAME) for mapping demo.\n\n# bps\nbps_majority_hex &lt;- exact_extract(US_200BPS, hex_grid_clipped, 'majority', append_cols = \"index\") %&gt;%\n  left_join(select(bps_conus_atts,\n                   VALUE,\n                   BPS_MODEL,\n                   BPS_NAME,\n                   FRI_ALLFIR),\n            by = c('majority' = 'VALUE'))\n\n# evt\nevt_majority_hex &lt;- exact_extract(US_240EVT, hex_grid_clipped, 'majority', append_cols = \"index\") %&gt;%\n  left_join(select(evt_conus_atts,\n                   VALUE,\n                   EVT_NAME,\n                   EVT_PHYS),\n            by = c('majority' = 'VALUE'))\n\n# Join both BpS and EVT attributes to hex shapefile\nhexs_bps_evt &lt;- hex_grid_clipped %&gt;%\n  left_join(bps_majority_hex, by = 'index') %&gt;%\n  left_join(evt_majority_hex, by = 'index')\n\n\n# save the shapefile for mapping in non-R applications or to read back into R\n\nst_write(hexs_bps_evt, \"outputs/bps_evt_hexs.shp\")"
  },
  {
    "objectID": "make_hex_map.html#make-the-map",
    "href": "make_hex_map.html#make-the-map",
    "title": "Make hexagon maps",
    "section": "Make the map",
    "text": "Make the map\nBelow we use our attributed hexgrid to make a clickable leaflet map with the BpS and EVT layers for our area of interest.\n\nhexs_bps_evt &lt;- st_read(\"outputs/bps_evt_hexs.shp\") \n\nReading layer `bps_evt_hexs' from data source \n  `C:\\Users\\rswaty\\Documents\\r_demos\\outputs\\bps_evt_hexs.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1648 features and 8 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -508742.8 ymin: 655736 xmax: -74984.26 ymax: 1177230\nProjected CRS: NAD83 / Conus Albers\n\nhexs_bps_evt &lt;- st_transform(hexs_bps_evt , crs = 4326)\n\n# Create a dynamic color palette\nbps_names &lt;- unique(hexs_bps_evt$BPS_NAME)\nevt_names &lt;- unique(hexs_bps_evt$EVT_NAME)\n\n# Use a colorblind-friendly base palette and expand it\nbase_palette &lt;- RColorBrewer::brewer.pal(8, \"Set2\")  # Set2 is colorblind-friendly\nbps_colors &lt;- colorRampPalette(base_palette)(length(bps_names))\n\npal_bps &lt;- colorFactor(\n  palette = bps_colors,\n  domain = bps_names\n)\n\n# Repeat for EVT\nevt_colors &lt;- colorRampPalette(base_palette)(length(evt_names))\n\npal_evt &lt;- colorFactor(\n  palette = evt_colors,\n  domain = evt_names\n)\n\n\n\n\n# Get the bounding box of the shapefile\nbbox &lt;- st_bbox(hexs_bps_evt)\n\n# Convert bounding box to named list\nbbox_list &lt;- as.list(bbox)\n\n# Convert named list to JSON\njson_output &lt;- toJSON(bbox_list, keep_vec_names = TRUE)\n\n\n\nleaflet(hexs_bps_evt) %&gt;%\n  addTiles() %&gt;%\n\n  fitBounds(lng1 = bbox_list$xmin, lat1 = bbox_list$ymin, lng2 = bbox_list$xmax, lat2 = bbox_list$ymax) %&gt;%\n\n  addPolygons(\n    fillColor = ~pal_bps(BPS_NAME),\n    color = \"#BDBDC3\",\n    weight = 1,\n    opacity = 1,\n    fillOpacity = 1.0,\n    highlightOptions = highlightOptions(\n      weight = 2,\n      color = \"#666\",\n      fillOpacity = 1.0,\n      bringToFront = TRUE\n    ),\n    label = ~BPS_NAME,\n    labelOptions = labelOptions(\n      style = list(\"font-weight\" = \"normal\", padding = \"3px 8px\"),\n      textsize = \"15px\",\n      direction = \"auto\"\n    ),\n    group = \"Biophysical Settings\"\n  ) %&gt;%\n  addPolygons(\n    fillColor = ~pal_evt(EVT_NAME),\n    color = \"#BDBDC3\",\n    weight = 1,\n    opacity = 1,\n    fillOpacity = 1.0,\n    highlightOptions = highlightOptions(\n      weight = 2,\n      color = \"#666\",\n      fillOpacity = 1.0,\n      bringToFront = TRUE\n    ),\n    label = ~EVT_NAME,\n    labelOptions = labelOptions(\n      style = list(\"font-weight\" = \"normal\", padding = \"3px 8px\"),\n      textsize = \"15px\",\n      direction = \"auto\"\n    ),\n    group = \"Existing Vegetation Types\"\n  ) %&gt;%\naddLayersControl(\n    overlayGroups = c(\"Biophysical Settings\", \"Existing Vegetation Types\"),\n    options = layersControlOptions(collapsed = FALSE)\n  ) %&gt;%\n  hideGroup(\"Existing Vegetation Types\") %&gt;% # Hide this group initially\n  addScaleBar(position = \"bottomleft\", options = scaleBarOptions(metric = TRUE, imperial = FALSE))"
  },
  {
    "objectID": "compiled_code.html",
    "href": "compiled_code.html",
    "title": "Compiled Code",
    "section": "",
    "text": "Below you will find several scripts that you can download and use for your convenience. Note, not all scripts totally stand alone, e.g., you will need to run previous code to get files. That said, we hope these speed up your work!"
  },
  {
    "objectID": "compiled_code.html#download-and-manage-landfire-data",
    "href": "compiled_code.html#download-and-manage-landfire-data",
    "title": "Compiled Code",
    "section": "Download and manage LANDFIRE data",
    "text": "Download and manage LANDFIRE data\nGet download_landfire_data.R that will access LANDFIRE‚Äôs data server, download data to your computer then unzip and rename the files."
  },
  {
    "objectID": "compiled_code.html#prepare-landfire-rasters",
    "href": "compiled_code.html#prepare-landfire-rasters",
    "title": "Compiled Code",
    "section": "Prepare LANDFIRE raster(s)",
    "text": "Prepare LANDFIRE raster(s)\nGet prepare_rasters.R that crops, masks and splits out downloaded LANDFIRE layer from stacked raster, build attribute tables, write files for use in R or other applications (e.g., ArcGIS pro or QGIS)."
  },
  {
    "objectID": "compiled_code.html#make-charts",
    "href": "compiled_code.html#make-charts",
    "title": "Compiled Code",
    "section": "Make charts",
    "text": "Make charts\nGet make_charts.R to make a couple basic charts with Biophysical Settings data. Easy to amend for other processed LANDFIRE datasets."
  },
  {
    "objectID": "compiled_code.html#process-events-data",
    "href": "compiled_code.html#process-events-data",
    "title": "Compiled Code",
    "section": "Process Events data",
    "text": "Process Events data\nGet event_data_processing.R to load Events data from tester geodatabase, process the data and clean up overlaps."
  }
]